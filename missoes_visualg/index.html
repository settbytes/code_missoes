<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1000, initial-scale=0.1">
    <title>Miss√µes VisuAlg: Exerc√≠cios de L√≥gica</title>
    <style>
        :root {
            --cor-fundo: #2c3e50;
            --cor-primaria: #2ecc71;
            --cor-secundaria: #3498db;
            --cor-terciaria: #e74c3c;
            --cor-texto-claro: #ecf0f1;
            --cor-cartao: #34495e;
            --cor-xp: #f1c40f;
        }

        body {
            font-family: 'Arial', sans-serif;
            background-color: var(--cor-fundo);
            color: var(--cor-texto-claro);
            margin: 0;
            padding: 0px;
			overflow-x: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container {
            width: 100%;
            max-width: 1000px;
        }

        /* --- Estilos para o Overlay do V√≠deo --- */
        #video-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background-color: var(--cor-fundo);
            z-index: 1050; /* Z-index maior que os modais */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            box-sizing: border-box;
            transition: opacity 0.5s ease;
        }

        .video-moldura {
            background-color: var(--cor-cartao);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
            margin-bottom: 20px;
            text-align: center;
	    position: relative;
        }

        .video-moldura video {
            display: block;
            width: 100%;
            max-width: 800px; /* Ajuste o tamanho m√°ximo do v√≠deo conforme desejado */
            height: auto;
            border-radius: 5px;
            border: 1px solid var(--cor-fundo);
        }

	/* --- Estilos para o Bot√£o Play Centralizado --- */
        #play-button-overlay {
            position: absolute; /* Posicionamento em rela√ß√£o ao .video-moldura */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%); /* Centraliza o elemento */
            width: 80px;
            height: 80px;
            background-color: rgba(0, 0, 0, 0.6); /* Fundo escuro semitransparente */
            border-radius: 50%; /* Faz o fundo ser um c√≠rculo */
            cursor: pointer;
            z-index: 1060; /* Acima do v√≠deo e do overlay */
            pointer-events: none; /* Inicialmente n√£o reage a cliques */
            opacity: 0; /* Come√ßa invis√≠vel */
            transition: opacity 0.3s;
        }

	/* O Tri√¢ngulo de Play √© feito com bordas */
        #play-button-overlay::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 55%; /* Ajuste para centralizar visualmente o tri√¢ngulo */
            transform: translate(-50%, -50%);
            border-style: solid;
            border-width: 15px 0 15px 25px;
            border-color: transparent transparent transparent var(--cor-texto-claro); /* Tri√¢ngulo branco/claro */
        }
        #btn-iniciar-pratica {
            background-color: var(--cor-primaria); /* Verde vibrante */
            color: var(--cor-fundo);
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.2em;
            letter-spacing: 1px;
            transition: background-color 0.3s, transform 0.1s;
        }

        #btn-iniciar-pratica:hover {
            background-color: #27ae60;
            transform: translateY(-2px);
        }
        /* --- Fim dos Estilos de Overlay --- */


        header {
            background-color: var(--cor-cartao);
            padding: 15px 30px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }

        header h1 {
            font-size: 1.8em;
            margin: 0;
            color: var(--cor-primaria);
            display: flex;
            align-items: center;
        }
        
        #btn-reset {
            background-color: var(--cor-terciaria);
            color: var(--cor-texto-claro);
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            font-size: 0.9em;
            margin-right: 20px;
            transition: background-color 0.3s, opacity 0.3s;
        }

        #btn-reset:hover {
            background-color: #c0392b;
        }

	#btn-menu-principal {
            background-color: var(--cor-secundaria); /* Azul */
            color: var(--cor-texto-claro);
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            font-size: 0.9em;
            margin-right: 20px; /* Garante espa√ßamento entre ele e o status-box */
            transition: background-color 0.3s, opacity 0.3s;
        }

        #btn-menu-principal:hover {
            background-color: #2980b9; /* Um azul um pouco mais escuro no hover */
        }

        .status-box {
            display: flex;
            gap: 20px;
        }

        .status-item {
            text-align: center;
            padding: 8px 15px;
            background-color: var(--cor-fundo);
            border-radius: 8px;
            min-width: 100px;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.5);
        }

        .status-item span {
            display: block;
            font-weight: bold;
            font-size: 1.5em;
        }

        #xp-value { color: var(--cor-xp); }
        #level-value { color: var(--cor-secundaria); }

        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--cor-cartao);
            width: 100%;
        }

        .tab-button {
            padding: 12px 25px;
            border: none;
            cursor: pointer;
            background-color: var(--cor-fundo);
            color: var(--cor-texto-claro);
            font-weight: bold;
            transition: background-color 0.3s, color 0.3s, border-bottom 0.3s;
            flex-grow: 1;
            text-align: center;
            border-radius: 5px 5px 0 0;
            opacity: 0.7;
        }
        
        .tab-button.locked {
            cursor: not-allowed;
            color: var(--cor-terciaria);
            opacity: 0.5;
            background-color: #2c3e50;
        }
        
        .tab-button.locked:hover {
            background-color: #2c3e50;
            color: var(--cor-terciaria);
            opacity: 0.7;
        }

        .tab-button.active {
            background-color: var(--cor-cartao);
            color: var(--cor-primaria);
            border-bottom: 3px solid var(--cor-primaria);
            opacity: 1;
        }
        
        #btn-basico.active { border-bottom-color: var(--cor-primaria); color: var(--cor-primaria);}
        #btn-intermediario.active { border-bottom-color: var(--cor-secundaria); color: var(--cor-secundaria);}
        #btn-avancado.active { border-bottom-color: var(--cor-terciaria); color: var(--cor-terciaria);}

        .missions-container {
            background-color: var(--cor-cartao);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }

        .mission-level { display: none; }
        .mission-level.active { display: block; }
        
        .mission-card {
            background-color: #2c3e50;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 5px solid var(--cor-primaria);
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .mission-card.intermediario { border-left-color: var(--cor-secundaria); }
        .mission-card.avancado { border-left-color: var(--cor-terciaria); }

        .mission-info {
            flex-grow: 1;
            padding-right: 45px; 
        }

        .mission-info h3 {
            margin: 0 0 5px 0;
            font-size: 1.1em;
            color: var(--cor-xp);
        }

        .mission-info p {
            margin: 0;
            font-size: 0.9em;
            line-height: 1.4;
            text-align: justify;
        }


        .mission-action button {
            min-width: 90px; 
            background-color: var(--cor-primaria);
            color: var(--cor-fundo);
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s, transform 0.1s;
        }

        .modal {
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.7);
            display: none;
            align-items: center;
            justify-content: center;
            padding: 10px;
            box-sizing: border-box;
        }
        
        #confirm-modal, #lock-modal {
            z-index: 1010;
        }
        
        .modal-content {
            background-color: var(--cor-fundo);
            padding: 20px 30px;
            border-radius: 10px;
            border: 3px solid var(--cor-xp);
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            animation: fadeIn 0.5s;
            width: fit-content; 
            max-width: calc(100% - 40px);
            box-sizing: border-box;
        }
        
        .modal-content.ultimate h2 {
            color: var(--cor-xp);
            font-size: clamp(1.2em, 4vw, 1.8em);
            white-space: nowrap; 
            margin-top: 0; 
            margin-bottom: 15px;
        }
        
        .modal-content.confirm h2 {
            color: var(--cor-terciaria);
        }

        .modal-buttons {
            margin-top: 20px;
            display: flex;
            justify-content: space-around;
            gap: 15px;
        }

        .close-button, .confirm-button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
        }
        
        .close-button {
            background-color: #7f8c8d;
            color: white;
        }
        
        .confirm-button.reset {
            background-color: var(--cor-terciaria);
            color: white;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

    </style>
</head>
<body>
    
    <div id="video-overlay">
        <div class="video-moldura">
            <video id="intro-video" width="800" controls autoplay playsinline> 
                <source src="avatar1.mp4" type="video/mp4">
                Seu navegador n√£o suporta a tag de v√≠deo.
            </video>
        </div>
        <button id="btn-iniciar-pratica" onclick="iniciarPratica()">COME√áAR A PRATICAR</button>
    </div>
    <audio id="motivational-audio" preload="auto"></audio>
    
    <audio id="audio-ultimate-4" src="audio4.mp3" preload="auto"></audio>
    
    <audio id="checkin-audio" src="checkin.mp3" preload="auto"></audio>

    <div id="motivational-modal" class="modal">
        <div class="modal-content" id="modal-content-area">
            <h2 id="modal-title">N√≠vel Conclu√≠do!</h2>
            <p id="modal-message"></p>
            <button class="close-button" onclick="closeModal()">√ìtimo!</button>
        </div>
    </div>
    
    <div id="confirm-modal" class="modal">
        <div class="modal-content confirm">
            <h2>üö® Aten√ß√£o! Confirma√ß√£o Necess√°ria</h2>
            <p>Tem certeza que deseja desmarcar todas as miss√µes e zerar seu XP e N√≠vel? Esta a√ß√£o n√£o pode ser desfeita.</p>
            <div class="modal-buttons">
                <button class="confirm-button reset" onclick="confirmReset()">Sim, Reiniciar Tudo</button>
                <button class="close-button" onclick="closeConfirmModal()">Cancelar</button>
            </div>
        </div>
    </div>
    
    <div id="lock-modal" class="modal">
        <div class="modal-content confirm">
            <h2>üîí N√≠vel Bloqueado!</h2>
            <p id="lock-message"></p>
            <button class="close-button" onclick="closeLockModal()">Entendi</button>
        </div>
    </div>

    <div class="container">
        <header>
            <h1 style="display: flex; align-items: center;">
                <span style="color:var(--cor-xp);">üõ†Ô∏è</span> Miss√µes VisuAlg
            </h1>
            
            <div style="display: flex; align-items: center;">
		<button id="btn-menu-principal" onclick="goToMainMenu()">Menu Principal</button>
                <button id="btn-reset" onclick="triggerResetConfirmation()">Reiniciar Tudo</button>
                <div class="status-box">
                    <div class="status-item">
                        <span>XP</span>
                        <span id="xp-value">0</span>
                    </div>
                    <div class="status-item">
                        <span>N√çVEL</span>
                        <span id="level-value">1</span>
                    </div>
                </div>
            </div>
        </header>
        
        <div class="tabs">
            <button class="tab-button active" id="btn-basico" onclick="showLevel('basico')">N√≠vel B√°sico</button>
            <button class="tab-button locked" id="btn-intermediario" onclick="showLevel('intermediario')">üîí N√≠vel Intermedi√°rio</button>
            <button class="tab-button locked" id="btn-avancado" onclick="showLevel('avancado')">üîí N√≠vel Avan√ßado</button>
        </div>

        <div class="missions-container">

            <div id="basico" class="mission-level active" data-level-name="N√≠vel B√°sico">
                <div class="mission-card basico" data-xp="100" data-id="B1" data-level="basico"><div class="mission-info"><h3>B1: Opera√ß√µes B√°sicas</h3><p>Crie um algoritmo que trabalhe com dois valores inteiros predefinidos (15 e 7). O programa deve calcular e exibir a soma e a multiplica√ß√£o desses dois n√∫meros.</p></div><div class="mission-action"><button onclick="toggleMission('B1', 100, 'basico')">Concluir</button></div></div>
                <div class="mission-card basico" data-xp="100" data-id="B2" data-level="basico"><div class="mission-info"><h3>B2: Entrada e Sa√≠da de Valores</h3><p>Elabore um programa que receba o pre√ßo unit√°rio de um item e a quantidade comprada pelo usu√°rio. O algoritmo deve calcular e exibir o valor total da compra.</p></div><div class="mission-action"><button onclick="toggleMission('B2', 100, 'basico')">Concluir</button></div></div>
                <div class="mission-card basico" data-xp="100" data-id="B3" data-level="basico"><div class="mission-info"><h3>B3: M√∫ltiplos Tipos de Dados</h3><p>Desenvolva um algoritmo que receba o nome de uma pessoa, sua idade (em anos) e sua altura (em metros). O programa deve exibir essas tr√™s informa√ß√µes juntas em uma √∫nica frase.</p></div><div class="mission-action"><button onclick="toggleMission('B3', 100, 'basico')">Concluir</button></div></div>
                <div class="mission-card basico" data-xp="100" data-id="B4" data-level="basico"><div class="mission-info"><h3>B4: Convers√£o de Temperatura</h3><p>Escreva um algoritmo que receba uma temperatura em graus Celsius. O programa deve converter e mostrar a temperatura equivalente em graus Fahrenheit.</p></div><div class="mission-action"><button onclick="toggleMission('B4', 100, 'basico')">Concluir</button></div></div>
                <div class="mission-card basico" data-xp="100" data-id="B5" data-level="basico"><div class="mission-info"><h3>B5: Resto e D√≠gitos</h3><p>Crie um programa que receba um n√∫mero inteiro de quatro d√≠gitos. O programa deve isolar e exibir apenas o √∫ltimo d√≠gito desse n√∫mero.</p></div><div class="mission-action"><button onclick="toggleMission('B5', 100, 'basico')">Concluir</button></div></div>
                <div class="mission-card basico" data-xp="100" data-id="B6" data-level="basico"><div class="mission-info"><h3>B6: Geometria Simples</h3><p>Crie um algoritmo que receba o comprimento do lado de um quadrado. O programa deve calcular e exibir o per√≠metro e a √°rea desse quadrado.</p></div><div class="mission-action"><button onclick="toggleMission('B6', 100, 'basico')">Concluir</button></div></div>
                <div class="mission-card basico" data-xp="100" data-id="B7" data-level="basico"><div class="mission-info"><h3>B7: M√©dia Ponderada</h3><p>Fa√ßa um programa que receba tr√™s notas de um aluno (pesos 2, 3 e 5). O programa deve calcular e exibir a m√©dia ponderada dessas notas.</p></div><div class="mission-action"><button onclick="toggleMission('B7', 100, 'basico')">Concluir</button></div></div>
            </div>

            <div id="intermediario" class="mission-level" data-level-name="N√≠vel Intermedi√°rio">
                <div class="mission-card intermediario" data-xp="200" data-id="I1" data-level="intermediario"><div class="mission-info"><h3>I1: Condi√ß√£o Simples</h3><p>Crie um algoritmo que receba um n√∫mero inteiro. Se o n√∫mero for maior que 10, o programa deve exibir uma mensagem confirmando essa condi√ß√£o.</p></div><div class="mission-action"><button onclick="toggleMission('I1', 200, 'intermediario')">Concluir</button></div></div>
                <div class="mission-card intermediario" data-xp="200" data-id="I2" data-level="intermediario"><div class="mission-info"><h3>I2: Estrutura Condicional Completa</h3><p>Desenvolva um programa que receba a idade de uma pessoa. O programa deve informar se a pessoa √© maior de idade ou menor de idade.</p></div><div class="mission-action"><button onclick="toggleMission('I2', 200, 'intermediario')">Concluir</button></div></div>
                <div class="mission-card intermediario" data-xp="200" data-id="I3" data-level="intermediario"><div class="mission-info"><h3>I3: Aumento Salarial (Condi√ß√£o com C√°lculo)</h3><p>Fa√ßa um algoritmo que receba o sal√°rio de um funcion√°rio. Se o sal√°rio for at√© R$ 1500, o reajuste √© de 15%. Caso contr√°rio, o reajuste √© de 10%. Calcule e exiba o novo sal√°rio.</p></div><div class="mission-action"><button onclick="toggleMission('I3', 200, 'intermediario')">Concluir</button></div></div>
                <div class="mission-card intermediario" data-xp="200" data-id="I4" data-level="intermediario"><div class="mission-info"><h3>I4: Identificando o Maior de Tr√™s</h3><p>Elabore um programa que receba tr√™s n√∫meros inteiros. O programa deve identificar e exibir qual dos tr√™s n√∫meros √© o maior.</p></div><div class="mission-action"><button onclick="toggleMission('I4', 200, 'intermediario')">Concluir</button></div></div>
                <div class="mission-card intermediario" data-xp="200" data-id="I5" data-level="intermediario"><div class="mission-info"><h3>I5: Condi√ß√£o e Desconto</h3><p>O programa deve receber o valor da compra e um c√≥digo (1: √† vista, 2: a prazo). Se o c√≥digo for 1, aplica um desconto de 10%. Exiba o valor final.</p></div><div class="mission-action"><button onclick="toggleMission('I5', 200, 'intermediario')">Concluir</button></div></div>
                <div class="mission-card intermediario" data-xp="200" data-id="I6" data-level="intermediario"><div class="mission-info"><h3>I6: Operadores L√≥gicos (E)</h3><p>Um aluno est√° aprovado se a m√©dia for 7 ou superior, e o n√∫mero de faltas for 10 ou menos. Fa√ßa o programa exibir o status desse aluno com base na m√©dia e n√∫mero de faltas.</p></div><div class="mission-action"><button onclick="toggleMission('I6', 200, 'intermediario')">Concluir</button></div></div>
                <div class="mission-card intermediario" data-xp="200" data-id="I7" data-level="intermediario"><div class="mission-info"><h3>I7: Geometria e Condi√ß√µes Aninhadas</h3><p>O algoritmo deve receber o comprimento de tr√™s segmentos de reta e verificar se formam um tri√¢ngulo. Se sim, o tri√¢ngulo deve ser classificado (equil√°tero, is√≥sceles ou escaleno).</p></div><div class="mission-action"><button onclick="toggleMission('I7', 200, 'intermediario')">Concluir</button></div></div>
            </div>

            <div id="avancado" class="mission-level" data-level-name="N√≠vel Avan√ßado">
                <div class="mission-card avancado" data-xp="300" data-id="A1" data-level="avancado"><div class="mission-info"><h3>A1: Sele√ß√£o M√∫ltipla</h3><p>O programa deve receber um n√∫mero inteiro entre 1 e 5. Em seguida, deve exibir o nome do n√∫mero por extenso. Se estiver fora do intervalo, deve mostrar uma mensagem de erro.</p></div><div class="mission-action"><button onclick="toggleMission('A1', 300, 'avancado')">Concluir</button></div></div>
                <div class="mission-card avancado" data-xp="300" data-id="A2" data-level="avancado"><div class="mission-info"><h3>A2: Repeti√ß√£o e Soma Condicional</h3><p>Fa√ßa um algoritmo que calcule e exiba a soma de todos os n√∫meros pares no intervalo de 1 a 50.</p></div><div class="mission-action"><button onclick="toggleMission('A2', 300, 'avancado')">Concluir</button></div></div>
                <div class="mission-card avancado" data-xp="300" data-id="A3" data-level="avancado"><div class="mission-info"><h3>A3: Repeti√ß√£o com Valida√ß√£o</h3><p>Escreva um programa que receba 10 n√∫meros inteiros e some apenas os n√∫meros que est√£o entre 10 e 50. O total da soma deve ser exibido ao final.</p></div><div class="mission-action"><button onclick="toggleMission('A3', 300, 'avancado')">Concluir</button></div></div>
                <div class="mission-card avancado" data-xp="300" data-id="A4" data-level="avancado"><div class="mission-info"><h3>A4: Sele√ß√£o M√∫ltipla (Calculadora)</h3><p>Elabore um algoritmo que simule uma calculadora: ele recebe dois n√∫meros e um c√≥digo de opera√ß√£o (1 a 4), executa a opera√ß√£o correspondente e exibe o resultado.</p></div><div class="mission-action"><button onclick="toggleMission('A4', 300, 'avancado')">Concluir</button></div></div>
                <div class="mission-card avancado" data-xp="300" data-id="A5" data-level="avancado"><div class="mission-info"><h3>A5: Repeti√ß√£o e Contagem</h3><p>Escreva um programa que receba a idade de 20 pessoas e fa√ßa os c√°lculos necess√°rios para exibir a m√©dia das idades e o total de pessoas maiores de idade.</p></div><div class="mission-action"><button onclick="toggleMission('A5', 300, 'avancado')">Concluir</button></div></div>
                <div class="mission-card avancado" data-xp="300" data-id="A6" data-level="avancado"><div class="mission-info"><h3>A6: Repeti√ß√£o (Fatorial)</h3><p>Fa√ßa um algoritmo que leia um n√∫mero inteiro positivo, calcule e exiba o fatorial desse n√∫mero.</p></div><div class="mission-action"><button onclick="toggleMission('A6', 300, 'avancado')">Concluir</button></div></div>
                <div class="mission-card avancado" data-xp="300" data-id="A7" data-level="avancado"><div class="mission-info"><h3>A7: Repeti√ß√£o com Sentinela e Min/M√°x</h3><p>O programa deve receber uma sequ√™ncia de n√∫meros positivos, interromper a leitura quando um n√∫mero negativo for digitado e exibir o maior e o menor n√∫mero positivo que foram lidos.</p></div><div class="mission-action"><button onclick="toggleMission('A7', 300, 'avancado')">Concluir</button></div></div>
            </div>
        </div>
    </div>

    <script>
        let currentXP = 0;
        const missions = {};
        
        const motivationalPhrases = [
            "Voc√™ √© um desbravador de algoritmos! Continue avan√ßando!",
            "Miss√£o completa! O futuro da programa√ß√£o est√° em suas m√£os.",
            "Cada linha de c√≥digo √© um passo para a excel√™ncia. Parab√©ns!",
            "Seu racioc√≠nio l√≥gico est√° afiado. Nada pode te parar agora.",
            "A persist√™ncia √© a chave do sucesso na programa√ß√£o. Voc√™ a dominou!",
            "Conquistou o n√≠vel! Seu c√≥digo para VisuAlg est√° ficando mais robusto e elegante.",
            "Um verdadeiro mestre do VisuAlg. Rumo ao pr√≥ximo desafio!",
            "O aprendizado √© cont√≠nuo, e voc√™ est√° no caminho certo. Avance!",
            "N√£o existe erro, existe aprendizado. E voc√™ aprende r√°pido!",
            "Seu desempenho est√° de outro n√≠vel. Que venham os pr√≥ximos desafios!",
            "Miss√£o dada √© miss√£o cumprida. Seu talento √© ineg√°vel!",
            "O poder da l√≥gica √© seu. Use-o para resolver problemas complexos.",
            "Parab√©ns! Sua dedica√ß√£o est√° construindo uma base s√≥lida.",
            "Miss√£o √©pica! Voc√™ acaba de desbloquear novas habilidades.",
            "Completou a lista! Celebre a vit√≥ria e prepare-se para o pr√≥ximo round."
        ];

        const motivationalAudio = document.getElementById('motivational-audio');
        const ultimateAudio4 = document.getElementById('audio-ultimate-4'); 
        const checkinAudio = document.getElementById('checkin-audio'); 
        const modalContent = document.getElementById('modal-content-area');
        const confirmModal = document.getElementById('confirm-modal');
        const lockModal = document.getElementById('lock-modal');
        const lockMessage = document.getElementById('lock-message');
        const levelAudioMap = {
            'basico': 'audio1.mp3',
            'intermediario': 'audio2.mp3',
            'avancado': 'audio3.mp3'
        };

	function startVideo() {
            const introVideo = document.getElementById('intro-video');
            const playButton = document.getElementById('play-button-overlay');

            if (introVideo) {
                // 1. Tenta dar play no v√≠deo
                introVideo.play().catch(error => {
                    console.error("N√£o foi poss√≠vel iniciar o v√≠deo.");
                });
                
                // 2. Esconde o √≠cone de play (agora que o v√≠deo est√° reproduzindo)
                if (playButton) {
                    playButton.style.opacity = '0';
                    playButton.style.pointerEvents = 'none';
                }
            }
        }
        
       // FUN√á√ÉO ORIGINAL: para fechar o OVERLAY
        function iniciarPratica() {
            const videoOverlay = document.getElementById('video-overlay');
            const introVideo = document.getElementById('intro-video');
            const playButton = document.getElementById('play-button-overlay');
            
            // Pausa o v√≠deo (caso esteja tocando, pois o usu√°rio quer sair do overlay)
            if (introVideo) {
                introVideo.pause();
            }

            // Esconde o √≠cone de play (apenas por garantia)
            if (playButton) {
                playButton.style.opacity = '0';
                playButton.style.pointerEvents = 'none';
            }

            // Inicia a transi√ß√£o de opacidade para ocultar o overlay suavemente
            videoOverlay.style.opacity = '0';
            
            // Remove o overlay do fluxo ap√≥s a transi√ß√£o
            setTimeout(() => {
                videoOverlay.style.display = 'none';
            }, 500); // 500ms corresponde ao tempo da transi√ß√£o CSS
        }

        function playCheckinAudio() {
            if (checkinAudio) {
                checkinAudio.currentTime = 0; 
                checkinAudio.play().catch(error => {
                    console.warn("A reprodu√ß√£o de √°udio 'checkin.mp3' foi bloqueada pelo navegador.");
                });
            }
        }

        function playLevelCompleteAudio(levelId) {
            const audioSrc = levelAudioMap[levelId];
            if (audioSrc) {
                motivationalAudio.onended = null;
                motivationalAudio.src = audioSrc;
                motivationalAudio.play().catch(error => {
                    console.warn("A reprodu√ß√£o de √°udio de n√≠vel foi bloqueada pelo navegador.");
                });
            }
        }
        
        function playUltimateCompletionAudio() {
            // Toca audio3.mp3
            motivationalAudio.onended = null;
            motivationalAudio.src = 'audio3.mp3';
            motivationalAudio.play().catch(error => {
                console.warn("A reprodu√ß√£o de √°udio 'audio3.mp3' foi bloqueada.");
            });
            
            // Toca audio4.mp3 (simultaneamente)
            if (ultimateAudio4) {
                 ultimateAudio4.volume = 1.0; 
                 ultimateAudio4.currentTime = 0;
                 ultimateAudio4.onended = null; 
                 ultimateAudio4.play().catch(error => {
                     console.warn("A reprodu√ß√£o de √°udio 'audio4.mp3' foi bloqueada.");
                 });
            }
        }


        function showMotivationalModal(title, message, isUltimate = false) {
            document.getElementById('modal-title').innerHTML = title;
            document.getElementById('modal-message').innerHTML = message;
            
            if (isUltimate) {
                modalContent.classList.add('ultimate');
            } else {
                modalContent.classList.remove('ultimate');
            }
            
            document.getElementById('motivational-modal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('motivational-modal').style.display = 'none';
            motivationalAudio.pause();
            motivationalAudio.currentTime = 0;
            motivationalAudio.onended = null; 
            
            // PAUSA O SEGUNDO √ÅUDIO (audio4.mp3)
            if (ultimateAudio4) {
                ultimateAudio4.pause();
                ultimateAudio4.currentTime = 0;
            }
        }

        function closeLockModal() {
            lockModal.style.display = 'none';
        }

        function triggerResetConfirmation() {
            confirmModal.style.display = 'flex';
        }

        function closeConfirmModal() {
            confirmModal.style.display = 'none';
        }

	function goToMainMenu() {
            window.location.href = "https://settbytes.github.io/code_missoes/";
        }

        function confirmReset() {
            // Zera o progresso
            resetAllMissions();
            
            // Fecha o modal de confirma√ß√£o
            closeConfirmModal();
            
            // Exibe o modal de feedback de rein√≠cio (que estava usando o alert)
            // Reutilizando o modal motivacional para dar feedback
            showMotivationalModal("Progresso Reiniciado!", "Todas as miss√µes foram desmarcadas. Rein√≠cio de progresso conclu√≠do!", false);
            
            // Garante que o n√≠vel B√°sico seja exibido
            showLevel('basico'); 
        }

        function showUltimateCompletionModal() {
            const ultimateMessage = "Lembre-se: ‚ÄúA excel√™ncia nada mais √© do que um amontoado de comportamentos que, isoladamente, nada t√™m de extraordin√°rio.‚Äù";
            const ultimateTitle = "üèÜ PARAB√âNS POR CONCLUIR TODAS AS MISS√ïES! üöÄ";
            showMotivationalModal(ultimateTitle, ultimateMessage, true);
        }
        
        // Vari√°vel de controle para ignorar eventos na inicializa√ß√£o
        let isInitialLoad = true; 

        // --- Fun√ß√µes de L√≥gica de Estado ---

        function loadState() {
            const savedMissions = localStorage.getItem('missions');
            if (savedMissions) {
                Object.assign(missions, JSON.parse(savedMissions));
            }
            // Chama updateAll para carregar o estado
            updateAll();
        }

        function saveState() {
            localStorage.setItem('missions', JSON.stringify(missions));
        }
        
        function isLevelCompleted(levelId) {
            const levelCards = document.querySelectorAll(`.mission-card[data-level="${levelId}"]`);
            if (levelCards.length === 0) return false;
            
            let completedCount = 0;
            levelCards.forEach(card => {
                const id = card.getAttribute('data-id');
                if (missions[id]) {
                    completedCount++;
                }
            });
            
            return completedCount === levelCards.length;
        }

        let completedLevels = { 
            'basico': false,
            'intermediario': false,
            'avancado': false
        };
        
        function resetAllMissions() {
            Object.keys(missions).forEach(key => delete missions[key]);
            localStorage.setItem('ultimate_completed', 'false');
            localStorage.removeItem('missions'); 
            // Define isInitialLoad como false antes de chamar updateScore para permitir notifica√ß√µes
            isInitialLoad = false; 
            updateScore(); 
            // REMOVIDO: alert("Todas as miss√µes foram desmarcadas. Rein√≠cio de progresso conclu√≠do!");
        }

        function calculateCurrentLevel() {
            if (isLevelCompleted('avancado') || isLevelCompleted('intermediario')) {
                return 3;
            } else if (isLevelCompleted('basico')) {
                return 2;
            } else {
                return 1;
            }
        }

        function updateLockState() {
            const basicCompleted = isLevelCompleted('basico');
            const intermediateCompleted = isLevelCompleted('intermediario');
            
            const btnIntermediario = document.getElementById('btn-intermediario');
            const btnAvancado = document.getElementById('btn-avancado');

            if (basicCompleted) {
                btnIntermediario.classList.remove('locked');
                btnIntermediario.textContent = 'N√≠vel Intermedi√°rio';
            } else {
                btnIntermediario.classList.add('locked');
                btnIntermediario.textContent = 'üîí N√≠vel Intermedi√°rio';
            }

            if (basicCompleted && intermediateCompleted) {
                btnAvancado.classList.remove('locked');
                btnAvancado.textContent = 'N√≠vel Avan√ßado';
            } else {
                btnAvancado.classList.add('locked');
                btnAvancado.textContent = 'üîí N√≠vel Avan√ßado';
            }
        }

        function updateScore() {
            currentXP = 0;
            let totalCompletedMissions = 0;
            const previousCompletedLevels = { ...completedLevels }; 
            
            completedLevels = { 'basico': false, 'intermediario': false, 'avancado': false };
            const totalMissions = document.querySelectorAll('.mission-card').length;

            document.querySelectorAll('.mission-card').forEach(card => {
                const id = card.getAttribute('data-id');
                const xp = parseInt(card.getAttribute('data-xp'));
                const button = card.querySelector('button');

                if (missions[id]) {
                    currentXP += xp;
                    totalCompletedMissions++;
                    button.classList.add('completed');
                    button.textContent = 'Refazer';
                    card.style.opacity = '0.6';
                } else {
                    button.classList.remove('completed');
                    button.textContent = 'Concluir';
                    card.style.opacity = '1';
                }
            });

            const currentLevel = calculateCurrentLevel();
            document.getElementById('xp-value').textContent = currentXP;
            document.getElementById('level-value').textContent = currentLevel;

            updateLockState(); 
            
            const isUltimateCompletion = (totalCompletedMissions === totalMissions);
            
            if (isUltimateCompletion) {
                const isUltimateCompletedPreviously = localStorage.getItem('ultimate_completed') === 'true';
                if (!isUltimateCompletedPreviously && !isInitialLoad) { 
                    showUltimateCompletionModal();
                    localStorage.setItem('ultimate_completed', 'true');
                }
            } else {
                 localStorage.setItem('ultimate_completed', 'false');
            }
            
            // 2. CHECAGEM DE N√çVEL
            ['basico', 'intermediario', 'avancado'].forEach(levelId => {
                const isLevelCurrentlyCompleted = isLevelCompleted(levelId);
                
                if (isLevelCurrentlyCompleted) {
                    completedLevels[levelId] = true;
                    
                    if (previousCompletedLevels[levelId] === false && !isInitialLoad) { 
                        
                        if (isUltimateCompletion && levelId === 'avancado') {
                             playUltimateCompletionAudio(); 
                             return; 
                        }
                        
                        const levelName = document.getElementById(levelId).getAttribute('data-level-name');
                        const randomIndex = Math.floor(Math.random() * motivationalPhrases.length);
                        const message = motivationalPhrases[randomIndex];
                        
                        showMotivationalModal(`${levelName} Conclu√≠do!`, message);
                        playLevelCompleteAudio(levelId);
                    }
                }
            });
            
            // Reinicia o controle de load inicial ap√≥s a primeira execu√ß√£o completa
            if (isInitialLoad) {
                 isInitialLoad = false;
            }

            saveState();
        }

        function toggleMission(id, xpValue, level) {
            const wasCompleted = missions[id];
            
            if (level === 'intermediario' && !isLevelCompleted('basico')) {
                lockMessage.textContent = "Para iniciar o N√≠vel Intermedi√°rio, voc√™ deve primeiro concluir todas as miss√µes do N√≠vel B√°sico.";
                lockModal.style.display = 'flex';
                return;
            } else if (level === 'avancado' && (!isLevelCompleted('basico') || !isLevelCompleted('intermediario'))) {
                lockMessage.textContent = "Para iniciar o N√≠vel Avan√ßado, voc√™ deve primeiro concluir todas as miss√µes do N√≠vel B√°sico e do N√≠vel Intermedi√°rio.";
                lockModal.style.display = 'flex';
                return;
            }

            if (wasCompleted) {
                missions[id] = false;
            } else {
                missions[id] = true;
            }
            
            playCheckinAudio(); 
            
            updateScore();
        }

        function showLevel(levelId) {
            const btn = document.getElementById(`btn-${levelId}`);
            
            if (btn.classList.contains('locked')) {
                if (levelId === 'intermediario') {
                    lockMessage.textContent = "Para iniciar o N√≠vel Intermedi√°rio, voc√™ deve primeiro concluir todas as miss√µes do N√≠vel B√°sico.";
                } else if (levelId === 'avancado') {
                    lockMessage.textContent = "Para iniciar o N√≠vel Avan√ßado, voc√™ deve primeiro concluir todas as miss√µes do N√≠vel B√°sico e do N√≠vel Intermedi√°rio.";
                }
                lockModal.style.display = 'flex';
                return;
            }

            document.querySelectorAll('.mission-level').forEach(div => {
                div.classList.remove('active');
            });
            document.getElementById(levelId).classList.add('active');

            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            btn.classList.add('active');
        }

        function updateAll() {
            updateLockState(); 
            showLevel('basico');
            updateScore();
        }

	// CORRE√á√ÉO: Tenta iniciar o v√≠deo automaticamente e carrega o estado em seguida.
        document.addEventListener('DOMContentLoaded', () => {
            loadState();
            
            const introVideo = document.getElementById('intro-video');
	        const playButton = document.getElementById('play-button-overlay'); // Adicionado
            
            // üõë IMPORTANTE: Removemos o introVideo.onended = iniciarPratica; aqui.
            // Para garantir que ele nunca feche sozinho, remova tamb√©m o 'controls' do HTML
            // OU apenas comente/ignore a linha, se ela estivesse na sua vers√£o anterior.

            if (introVideo) {
                // Tenta reproduzir. Se o navegador bloquear, ele cair√° no .catch
                introVideo.play().catch(error => {
                    // SE o autoplay falhar, mostramos o √≠cone de play:
                    if (playButton) {
                        playButton.style.opacity = '1';
                        playButton.style.pointerEvents = 'auto'; // Habilita o clique no √≠cone
                        
                        // Configura o clique no √≠cone para chamar a fun√ß√£o startVideo
                        playButton.onclick = startVideo;
                    }
                    console.warn("A reprodu√ß√£o autom√°tica do v√≠deo foi bloqueada pelo navegador.");
                });
            }
        });

    </script>

</body>
</html>










